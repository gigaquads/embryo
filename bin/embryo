#!/usr/bin/env python3
# encoding=utf8
# vim: set filetype=python

import argparse
import sys
from appyratus.util.argz import Prog

from embryo.create import EmbryoGenerator

PROG = dict(
    prog="embryo",
    name="Embryo",
    version="0",
    tagline="Anaconda Beware",
)

SUBPARSERS = [
    dict(
        name='create',
        help='generate new embryo',
        defaults=dict(action='create'),
        args=[
            dict(
                flags=('embryo', ),
                type=str,
                help="The name of the embryo for embryonic generation."
            ),
            dict(
                flags=('-d', '--dest'),
                type=str,
                default='./',
                help=
                "Destination path to the directory where the embryo should be generated."
            ),
            dict(
                flags=('-n', '--name'),
                type=str,
                default='',
                help="The name of the project you're creating."
            ),
            dict(
                flags=('-c', '--context'),
                help="Path to a context .json or .yml file.",
            )
        ]
    )
]

def main():
    """
    Main
    """
    prog = Prog(prog=PROG, subparsers=SUBPARSERS)
    if prog.args.action == 'create':
        create = EmbryoGenerator.from_args(prog.args)
    else:
        prog.print_usage()


if __name__ == "__main__":
    try:
        main()
    except Exception as error:
        print("ERROR {}".format(error))
        raise error
